<!DOCTYPE html>
<!-- saved from url=(0076)https://web.stanford.edu/class/cs234/assignments/21winter_release/index.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>CS234: Reinforcement Learning</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Course materials and notes for Stanford class CS234: Reinforcement Learning.">
    <link rel="canonical" href="http://web.stanford.edu/class/cs234/assignment1/index.html">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="./CS234_ Reinforcement Learning_files/main.css">

    <!-- Google fonts -->
    <link href="./CS234_ Reinforcement Learning_files/css" rel="stylesheet" type="text/css">

<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">.MathJax_Preview .MJXc-math {color: inherit!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXc-script {font-size: .8em}
.MJXc-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXc-bold {font-weight: bold}
.MJXc-italic {font-style: italic}
.MJXc-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-largeop {font-size: 150%}
.MJXc-largeop.MJXc-int {vertical-align: -.2em}
.MJXc-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXc-display {display: block; text-align: center; margin: 1em 0}
.MJXc-math span {display: inline-block}
.MJXc-box {display: block!important; text-align: center}
.MJXc-box:after {content: " "}
.MJXc-rule {display: block!important; margin-top: .1em}
.MJXc-char {display: block!important}
.MJXc-mo {margin: 0 .15em}
.MJXc-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXc-denom {display: inline-table!important; width: 100%}
.MJXc-denom > * {display: table-row!important}
.MJXc-surd {vertical-align: top}
.MJXc-surd > * {display: block!important}
.MJXc-script-box > *  {display: table!important; height: 50%}
.MJXc-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXc-script-box > *:last-child > * {vertical-align: bottom}
.MJXc-script-box > * > * > * {display: block!important}
.MJXc-mphantom {visibility: hidden}
.MJXc-munderover {display: inline-table!important}
.MJXc-over {display: inline-block!important; text-align: center}
.MJXc-over > * {display: block!important}
.MJXc-munderover > * {display: table-row!important}
.MJXc-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXc-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXc-mtr {display: table-row!important}
.MJXc-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXc-mtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-mlabeledtr {display: table-row!important}
.MJXc-mlabeledtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mlabeledtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXc-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXc-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXc-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXc-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXc-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXc-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXc-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXc-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXc-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXc-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_CHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

   <body><div id="MathJax_Message" style="display: none;"></div>

    <header class="site-header">

  <div class="wrap title-wrap">
    <a class="site-title" href="https://cs234.stanford.edu/">CS234: Reinforcement Learning</a>
  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1></h1>
  </header>

  <article class="post-content">

<h2>Assignment 2: Playing Pong with Deep Q Learning</h2>

<p><b>
Part 1: Question 0-4: Due Date: 2/5 (Fri) 6:00 PM (18:00) PST. <br>
Part 2: Question 5-6: Due Date: 2/12 (Fri) 6:00 PM (18:00) PST. <br>
See course webpage for the  <a href="http://web.stanford.edu/class/cs234/index.html#lateday">late day policy</a>.
</b></p>

<p>In this assignment, you will use Q-learning with function approximators (deep Q-network) to play games! We will use Open AI gym for the Atari environment. Please note that it takes more than 8 hours for Pong to train so please start early.
</p>
<ul>
  <li>understand the basic <strong>Q-learning</strong> method.</li>
  <li>understand the use of <strong>experience replay </strong>, <strong>target network </strong> and the selection of <strong>hyperparameter tuning</strong>.</li>
  <li>implement and apply a <strong>linear approximator</strong> on the Pong game.</li>
  <li>implement and apply the <strong>DQN</strong> on the Pong game.</li>
  <li>understand the differences and tradeoffs between these two approximators.</li>
</ul>
<h2>Tasks</h2>
<p>There are 2 parts to this assignment: written and code components.</p>
<p>The coding assignment, including some starter code, is available <a href="https://web.stanford.edu/class/cs234/assignments/21winter_release/starter_code_torch.zip">here</a>.
</p><p>The written homework questions are available <a href="https://web.stanford.edu/class/cs234/assignments/21winter_release/handout.pdf">here</a>. 
</p><p>If you would like to typeset your solution, we have provided our assignment2 LaTex file <a href="https://web.stanford.edu/class/cs234/assignments/21winter_release/handout.zip">here</a>. <strong>PLEASE DO NOT REDISTRIBUTE THIS FILE WITH ANYONE OUTSIDE THE CLASS!</strong></p>

<h2>Setup</h2>
<h3>Working remotely on Azure</h3>
<p><b>(highly recommended for training on Pong)</b></p>

As part of this course, you can use Azure for your assignments. We recommend this route for anyone who is having trouble with installation set-up, or if you would like to use better CPU/GPU resources than you may have locally. Please see the set-up tutorial <a href="https://docs.google.com/document/d/14xea9zwI3xUCNw8JWREHH5iWjKS5gNNYu_uyP3JcFAQ/edit?usp=sharing">here</a> for more details.

<h3>Working locally</h3>

<b>While you are waiting for the Azure subscriptions to be set up, you can get started on all problems except q5 and q6 (Pong).</b>

<p><i>Note: Please be sure you have <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/install/download.html#anaconda-or-miniconda">Anaconda or Miniconda</a> installed. The following instructions should work on all platforms. If you have any trouble getting set up, please come to office hours and the TAs will be happy to help.</i></p>

<p>
  <b>Create conda environment on your local system</b>: replace &lt;your-system&gt; with your system, either mac or windows
  </p><pre>    <code class="language-bash" data-lang="bash"><span class="nb">cd</span> starter_code_torch
    conda env create -f cs234-torch-&lt;your-system&gt;.yml
    conda activate cs234-torch</code>
  </pre>
<p></p>

<!-- 
<p><b>[Optional] virtual environment</b>: Once you have unzipped the starter code, you might want to create a <a href="https://docs.python-guide.org/en/latest/dev/virtualenvs/">virtual environment</a> for the project. If you choose not to use a virtual environment, it is up to you to make sure that all dependencies for the code are installed on your machine. To set up a virtual environment, run the following:</p>

<div class="highlight">
<pre><code class="language-bash" data-lang="bash"><span class="nb">cd</span> assignment2
sudo pip install virtualenv      <span class="c"># This may already be installed</span>
virtualenv .env --python=python3.6 <span class="c"># Create a virtual environment</span>
<span class="nb">source</span> .env/bin/activate         <span class="c"># Activate the virtual environment</span> 
pip install -r requirements.txt  <span class="c"># For Mac, edit this file to change "tensorflow-gpu" to "tensorflow"</span>
sudo apt-get install cmake       <span class="c"># For Linux</span>
sudo apt-get install zlib1g-dev  <span class="c"># For Linux</span>
sudo apt-get install ffmpeg      <span class="c"># For Linux</span>
brew install zlib                <span class="c"># For Mac</span>
brew install ffmpeg              <span class="c"># For Mac</span>
<span class="c"># Work on the assignment for a while ...</span>
deactivate                       <span class="c"># Exit the virtual environment</span>
</code></pre>
</div>

<p><b>Install requirements (without a virtual environment)</b>: To install the required packages locally without setting up a virtual environment, run the following:</p>

<div class="highlight">
<pre><code class="language-bash" data-lang="bash"><span class="nb">cd</span> assignment2
pip install -r requirements.txt  <span class="c"># For Mac, edit this file to change "tensorflow-gpu" to "tensorflow"</span>
sudo apt-get install cmake       <span class="c"># For Linux</span>
sudo apt-get install zlib1g-dev  <span class="c"># For Linux</span>
sudo apt-get install ffmpeg      <span class="c"># For Linux</span>
brew install zlib                <span class="c"># For Mac</span>
brew install ffmpeg              <span class="c"># For Mac</span>
</code></pre>
</div> -->

<h2>Notes</h2>
<strong>NOTE 1:</strong> Please start early!

<h2>Submitting your work</h2>

Submit both your written assignment and coding assignment by following the <a href="http://web.stanford.edu/class/cs234/assignments.html"><b class="boldblue">Submission Instructions</b></a>.



<!--

<p>See Piazza for more submission instructions. Remember, you MUST follow the instructions and submit your code and writeup.</p>

<p>Once you are done working, run <code>make submit</code> and transfer the zip file to the corn machine. In the corn machine, use <code>/afs/ir/class/cs234/submit</code> to submit the coding part.</p>

<p>For the written component, please upload a PDF file of your solutions to Gradescope. When asked to map question parts to your PDF, please map the parts accordingly as courtesy to your TAs. This is crucial so that we can provide accurate feedback. If a question has no written component (completely programmatic), map it on the same page as the previous section or next section.</p> -->


<div id="classicons">
<h2>Reference papers</h2>
<ul>
  <li> Human-level control through deep reinforcement learning, V. Mnih et al., Nature, 2015.</li>
  <li>Playing Atari with Deep Reinforcement Learning, V. Mnih et al., NIPS Workshop, 2013.</li>
</ul>
</div>
<!--

<p>Once you are done working, run <code>make submit</code>; this will produce a file called <code>assignment1.zip</code>. Rename this file to <code>&lt;your-sunet-id&gt;.zip</code>, for instance if your stanford email is <code>jdoe@stanford.edu</code>, your file name should be
<div class="highlight">
<pre><code class="language-bash" data-lang="bash"><span class="nb">cd</span> utils/datasets
jdoe.zip
</code></pre>
</div>

Upload this file to <a href="https://stanford.box.com/signup/collablink/d_3367429916/116c2072133f72">the Box for this assignment</a>.</p>


<p>For the written component, please upload a PDF file of your solutions to Gradescope. If you are enrolled in the class you should have been signed up automatically. If you added the class late or are not signed up, post privately to Piazza and we will add you to the roster. When asked to map question parts to your PDF, please map the parts accordingly as courtesy to your TAs. This is crucial so that we can provide accurate feedback. If a question has no written component (completely programmatic), map it on the same page as the previous section or next section.</p> -->

    <!-- mathjax -->
    <script type="text/javascript" src="./CS234_ Reinforcement Learning_files/MathJax.js"></script>

<div id="feedly-mini" title="feedly Mini tookit"></div>
</article></div></div></div>
</body></html>